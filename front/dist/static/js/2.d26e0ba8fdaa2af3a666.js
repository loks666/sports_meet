webpackJsonp([2],{MEvW:function(e,t){},"R/UW":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={border:!0,index:!0,indexLabel:"序号",stripe:!0,calcHeight:30,searchMenuSpan:4,searchSpan:5,dialogDrag:!0,searchBtn:!1,viewBtn:!0,editBtn:!1,page:!1,addBtn:!1,align:"center",menuAlign:"center",formslot:!0,column:[{label:"姓名",prop:"usersName"},{label:"学号",prop:"usersStnumber",editDisabled:!0},{label:"院系",prop:"collegeName",type:"select",rules:[{required:!0,message:"请选择院系",trigger:"blur"}],dicData:[{label:"理工学院",value:"理工学院"},{label:"体育与健康学院",value:"体育与健康学院"},{label:"语言文学学院",value:"语言文学学院"},{label:"马克思学院",value:"马克思学院"},{label:"经济与管理学院",value:"经济与管理学院"},{label:"教育与音乐学院",value:"教育与音乐学院"},{label:"艺术与设计学院",value:"艺术与设计学院"},{label:"商贸与法律学院",value:"商贸与法律学院"},{label:"传媒学院",value:"传媒学院"}]},{label:"状态",type:"switch",slot:!0,editDisabled:!0,dicData:[{label:"未发布",value:"0"},{label:"已发布",value:"1"}],prop:"draftState"},{label:"内容",prop:"draftContent"}]},r=a("2CGT"),o={data:function(){return{option:s,form:{usersStnumber:"",usersName:"",collegeName:"",draftContent:"",draftState:""},paramsTest:[],data:[],search:"",currentPage:1,pageSize:10,total:0,remnant:300,users_ne:"",users_nb:"",college_ne:"",dialogFormVisible:!1,formLabelWidth:"90px"}},created:function(){this.searchLiset(),this.getUser()},methods:{descInput:function(){var e=this.form.draftContent.length;this.remnant=300-e},getUser:function(){var e=this;Object(r.P)({params:{usersStnumber:window.sessionStorage.getItem("id")}}).then(function(t){console.log("顶部用户数据====》",t),e.dataList=t.data.data.records,e.form.usersStnumber=t.data.data.records[0].usersStnumber,e.form.usersName=t.data.data.records[0].usersName,e.form.collegeName=t.data.data.records[0].collegeName,e.form.draftState="0"})},searchLiset:function(){var e=this;Object(r.m)({params:{PageNum:this.currentPage,PageSize:this.pageSize,usersStnumber:window.sessionStorage.getItem("id")}}).then(function(t){console.log(t.data.data.records),console.log("111"),e.data=t.data.data.records,e.total=t.data.data.total})},insert:function(){var e=this;this.paramsTest=this.form,"0"==this.form.draftState?this.paramsTest.draftState=0:this.paramsTest.draftState=1,Object(r.l)(this.paramsTest).then(function(t){e.searchLiset(),"200"==t.data.code?e.$message({type:"success",message:"加油稿发布成功"}):e.$message({type:"error",message:"加油稿发布失败"}),e.dialogFormVisible=!1}),console.log("999")},update:function(e,t,a,s){var r=this;UupdateAPI(e).then(function(e){a(),r.searchLiset(),console.log(e),"200"==e.data.code?r.$message({type:"success",message:"更新成功"}):r.$message({type:"error",message:"更新失败"})}).catch(function(){s()}),console.log(e)},deletes:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return Object(r.j)(e.draftId)}).then(function(e){t.searchLiset(),"200"==e.data.code?t.$message({type:"success",message:"删除成功"}):t.$message({type:"error",message:"删除失败"}),console.log(e)})},emptyInput:function(){this.users_ne="",this.users_nb="",this.college_ne=""},refreshList:function(){this.getList()},sizeChange:function(e){this.page.pageSize=e},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"as"},[a("basic-container",[a("avue-crud",{attrs:{data:e.data,option:e.option},on:{"size-change":e.sizeChange,"row-update":e.update,"row-save":e.insert,"row-del":e.deletes,"refresh-change":e.refreshList},scopedSlots:e._u([{key:"draftState",fn:function(t){return[a("el-switch",{staticClass:"switch",attrs:{"active-color":"#409EFF","active-text":"已审核","active-value":"1",disabled:"","inactive-color":"#CCCCCC","inactive-text":"未审核","inactive-value":"0"},model:{value:t.row.draftState,callback:function(a){e.$set(t.row,"draftState",a)},expression:"scope.row.draftState"}})]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[e._v(" "),a("template",{slot:"menuLeft"},[a("el-button",{attrs:{icon:"el-icon-edit",type:"success"},nativeOn:{click:function(t){e.dialogFormVisible=!0}}},[e._v("发布加油稿")])],1),e._v("\n      >\n\n    ")],2)],1),e._v(" "),a("div",{staticStyle:{margin:"10px 0"}},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[5,10,20],total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogFormVisible,title:"加油稿发布"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"姓名:"}},[a("el-input",{attrs:{disabled:!0,autocomplete:"off"},model:{value:e.form.usersName,callback:function(t){e.$set(e.form,"usersName",t)},expression:"form.usersName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"学号:"}},[a("el-input",{attrs:{disabled:!0,autocomplete:"off"},model:{value:e.form.usersStnumber,callback:function(t){e.$set(e.form,"usersStnumber",t)},expression:"form.usersStnumber"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"学院:"}},[a("el-tag",{staticStyle:{float:"left"},attrs:{size:"medium"}},[e._v(e._s(e.form.collegeName))])],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"状态:",prop:"number"}},[a("el-radio",{attrs:{disabled:"",label:"0"},model:{value:e.form.draftState,callback:function(t){e.$set(e.form,"draftState",t)},expression:"form.draftState"}},[e._v("未审核")]),e._v(" "),a("el-radio",{attrs:{disabled:"",label:"1"},model:{value:e.form.draftState,callback:function(t){e.$set(e.form,"draftState",t)},expression:"form.draftState"}},[e._v("已审核")])],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"内容:"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.draftContent,expression:"form.draftContent"}],staticClass:"textar",attrs:{cols:"77",maxlength:"300",minlength:"3",rows:"6"},domProps:{value:e.form.draftContent},on:{input:[function(t){t.target.composing||e.$set(e.form,"draftContent",t.target.value)},e.descInput]}}),e._v(" "),a("i",[a("span",[e._v("内容字数0~300字以内，剩余字数:"+e._s(e.remnant)+"/300")])])])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.insert}},[e._v("发 布")])],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(o,l,!1,function(e){a("MEvW")},null,null);t.default=n.exports}});
//# sourceMappingURL=2.d26e0ba8fdaa2af3a666.js.map